// Generated by Haxe 4.0.2
#include <hxcpp.h>

#ifndef INCLUDED_haxe_IMap
#include <haxe/IMap.h>
#endif
#ifndef INCLUDED_haxe_ds_BalancedTree
#include <haxe/ds/BalancedTree.h>
#endif
#ifndef INCLUDED_haxe_ds_EnumValueMap
#include <haxe/ds/EnumValueMap.h>
#endif
#ifndef INCLUDED_tink__Url_Url_Impl_
#include <tink/_Url/Url_Impl_.h>
#endif
#ifndef INCLUDED_tink_core_LinkObject
#include <tink/core/LinkObject.h>
#endif
#ifndef INCLUDED_tink_core_NamedWith
#include <tink/core/NamedWith.h>
#endif
#ifndef INCLUDED_tink_core_Outcome
#include <tink/core/Outcome.h>
#endif
#ifndef INCLUDED_tink_core_TypedError
#include <tink/core/TypedError.h>
#endif
#ifndef INCLUDED_tink_core__Future_FutureObject
#include <tink/core/_Future/FutureObject.h>
#endif
#ifndef INCLUDED_tink_core__Future_Future_Impl_
#include <tink/core/_Future/Future_Impl_.h>
#endif
#ifndef INCLUDED_tink_core__Future_SyncFuture
#include <tink/core/_Future/SyncFuture.h>
#endif
#ifndef INCLUDED_tink_core__Lazy_LazyConst
#include <tink/core/_Lazy/LazyConst.h>
#endif
#ifndef INCLUDED_tink_core__Lazy_LazyObject
#include <tink/core/_Lazy/LazyObject.h>
#endif
#ifndef INCLUDED_tink_core__Promise_Promise_Impl_
#include <tink/core/_Promise/Promise_Impl_.h>
#endif
#ifndef INCLUDED_tink_http_ClientObject
#include <tink/http/ClientObject.h>
#endif
#ifndef INCLUDED_tink_http_ClientType
#include <tink/http/ClientType.h>
#endif
#ifndef INCLUDED_tink_http_Container
#include <tink/http/Container.h>
#endif
#ifndef INCLUDED_tink_http_Fetch
#include <tink/http/Fetch.h>
#endif
#ifndef INCLUDED_tink_http_Header
#include <tink/http/Header.h>
#endif
#ifndef INCLUDED_tink_http_HeaderField
#include <tink/http/HeaderField.h>
#endif
#ifndef INCLUDED_tink_http_IncomingResponse
#include <tink/http/IncomingResponse.h>
#endif
#ifndef INCLUDED_tink_http_Message
#include <tink/http/Message.h>
#endif
#ifndef INCLUDED_tink_http_OutgoingRequest
#include <tink/http/OutgoingRequest.h>
#endif
#ifndef INCLUDED_tink_http_OutgoingRequestHeader
#include <tink/http/OutgoingRequestHeader.h>
#endif
#ifndef INCLUDED_tink_http_RequestHeader
#include <tink/http/RequestHeader.h>
#endif
#ifndef INCLUDED_tink_http_ResponseHeaderBase
#include <tink/http/ResponseHeaderBase.h>
#endif
#ifndef INCLUDED_tink_http__Client_CustomClient
#include <tink/http/_Client/CustomClient.h>
#endif
#ifndef INCLUDED_tink_http_clients_CurlClient
#include <tink/http/clients/CurlClient.h>
#endif
#ifndef INCLUDED_tink_http_clients_LocalContainerClient
#include <tink/http/clients/LocalContainerClient.h>
#endif
#ifndef INCLUDED_tink_http_clients_SecureCurlClient
#include <tink/http/clients/SecureCurlClient.h>
#endif
#ifndef INCLUDED_tink_http_clients_SecureSocketClient
#include <tink/http/clients/SecureSocketClient.h>
#endif
#ifndef INCLUDED_tink_http_clients_SocketClient
#include <tink/http/clients/SocketClient.h>
#endif
#ifndef INCLUDED_tink_http_clients_StdClient
#include <tink/http/clients/StdClient.h>
#endif
#ifndef INCLUDED_tink_http_containers_LocalContainer
#include <tink/http/containers/LocalContainer.h>
#endif
#ifndef INCLUDED_tink_io_WorkerObject
#include <tink/io/WorkerObject.h>
#endif
#ifndef INCLUDED_tink_io__Source_Source_Impl_
#include <tink/io/_Source/Source_Impl_.h>
#endif
#ifndef INCLUDED_tink_streams_StreamObject
#include <tink/streams/StreamObject.h>
#endif

HX_LOCAL_STACK_FRAME(_hx_pos_f48f5e3cc0066c7c_55_fetch,"tink.http.Fetch","fetch",0xf215f9fc,"tink.http.Fetch.fetch","tink/http/Fetch.hx",55,0xb84ee46e)
HX_LOCAL_STACK_FRAME(_hx_pos_f48f5e3cc0066c7c_60_fetch,"tink.http.Fetch","fetch",0xf215f9fc,"tink.http.Fetch.fetch","tink/http/Fetch.hx",60,0xb84ee46e)
HX_LOCAL_STACK_FRAME(_hx_pos_f48f5e3cc0066c7c_27_fetch,"tink.http.Fetch","fetch",0xf215f9fc,"tink.http.Fetch.fetch","tink/http/Fetch.hx",27,0xb84ee46e)
HX_LOCAL_STACK_FRAME(_hx_pos_f48f5e3cc0066c7c_71_getClient,"tink.http.Fetch","getClient",0x9ad54243,"tink.http.Fetch.getClient","tink/http/Fetch.hx",71,0xb84ee46e)
HX_LOCAL_STACK_FRAME(_hx_pos_f48f5e3cc0066c7c_22_boot,"tink.http.Fetch","boot",0x49170cb0,"tink.http.Fetch.boot","tink/http/Fetch.hx",22,0xb84ee46e)
HX_LOCAL_STACK_FRAME(_hx_pos_f48f5e3cc0066c7c_23_boot,"tink.http.Fetch","boot",0x49170cb0,"tink.http.Fetch.boot","tink/http/Fetch.hx",23,0xb84ee46e)
namespace tink{
namespace http{

void Fetch_obj::__construct() { }

Dynamic Fetch_obj::__CreateEmpty() { return new Fetch_obj; }

void *Fetch_obj::_hx_vtable = 0;

Dynamic Fetch_obj::__Create(hx::DynamicArray inArgs)
{
	hx::ObjectPtr< Fetch_obj > _hx_result = new Fetch_obj();
	_hx_result->__construct();
	return _hx_result;
}

bool Fetch_obj::_hx_isInstanceOf(int inClassId) {
	return inClassId==(int)0x00000001 || inClassId==(int)0x640e87e0;
}

 ::haxe::ds::EnumValueMap Fetch_obj::client;

 ::haxe::ds::EnumValueMap Fetch_obj::sclient;

::Dynamic Fetch_obj::fetch( ::Dynamic url, ::Dynamic options){
            		HX_BEGIN_LOCAL_FUNC_S2(hx::LocalFunc,_hx_Closure_2, ::Dynamic,options, ::Dynamic,url) HXARGC(1)
            		void _hx_run( ::Dynamic cb){
            			HX_BEGIN_LOCAL_FUNC_S4(hx::LocalFunc,_hx_Closure_1,bool,followRedirect, ::Dynamic,options, ::Dynamic,url, ::Dynamic,cb) HXARGC(1)
            			void _hx_run( ::tink::core::Outcome res){
            				HX_GC_STACKFRAME(&_hx_pos_f48f5e3cc0066c7c_55_fetch)
HXLINE(  55)				switch((int)(res->_hx_getIndex())){
            					case (int)0: {
HXLINE(  56)						 ::tink::http::IncomingResponse res1 = ( ( ::tink::http::IncomingResponse)(res->_hx_getObject(0)) );
HXLINE(  57)						{
HXLINE(  57)							int _g = ( ( ::tink::http::ResponseHeaderBase)(res1->header) )->statusCode;
HXDLIN(  57)							switch((int)(_g)){
            								case (int)301: case (int)302: case (int)303: case (int)307: case (int)308: {
HXLINE(  58)									int code = _g;
HXDLIN(  58)									if (followRedirect) {
            										HX_BEGIN_LOCAL_FUNC_S3(hx::LocalFunc,_hx_Closure_0, ::Dynamic,options,int,code, ::Dynamic,url) HXARGC(1)
            										::Dynamic _hx_run(::String location){
            											HX_GC_STACKFRAME(&_hx_pos_f48f5e3cc0066c7c_60_fetch)
HXLINE(  60)											 ::Dynamic this3 = ::tink::_Url::Url_Impl__obj::resolve(url,::tink::_Url::Url_Impl__obj::fromString(location));
HXDLIN(  60)											 ::Dynamic this4;
HXDLIN(  60)											if ((code == 303)) {
HXLINE(  60)												 ::Dynamic _hx___ret =  ::Dynamic(hx::Anon_obj::Create(1)
            													->setFixed(0,HX_("method",e1,f6,5a,09),HX_("GET",76,1c,36,00)));
HXDLIN(  60)												{
HXLINE( 116)													{
HXLINE( 116)														 ::Dynamic _g1 = options->__Field(HX_("augment",11,3c,02,20),hx::paccDynamic);
HXLINE(   1)														if (hx::IsNotNull( _g1 )) {
HXLINE( 116)															 ::Dynamic v = _g1;
HXDLIN( 116)															_hx___ret->__SetField(HX_("augment",11,3c,02,20),v,hx::paccDynamic);
            														}
            													}
HXLINE( 113)													{
HXLINE( 113)														::Dynamic _g11 =  ::Dynamic(options->__Field(HX_("body",a2,7a,1b,41),hx::paccDynamic));
HXLINE(   1)														if (hx::IsNotNull( _g11 )) {
HXLINE( 113)															::Dynamic v1 = _g11;
HXDLIN( 113)															_hx___ret->__SetField(HX_("body",a2,7a,1b,41),v1,hx::paccDynamic);
            														}
            													}
HXLINE( 114)													{
HXLINE( 114)														 ::tink::http::ClientType _g2 = options->__Field(HX_("client",4b,ca,4f,0a),hx::paccDynamic);
HXLINE(   1)														if (hx::IsNotNull( _g2 )) {
HXLINE( 114)															 ::tink::http::ClientType v2 = _g2;
HXDLIN( 114)															_hx___ret->__SetField(HX_("client",4b,ca,4f,0a),v2,hx::paccDynamic);
            														}
            													}
HXLINE( 115)													{
HXLINE( 115)														 ::Dynamic _g3 = options->__Field(HX_("followRedirect",ad,9d,29,cf),hx::paccDynamic);
HXLINE(   1)														if (hx::IsNotNull( _g3 )) {
HXLINE( 115)															 ::Dynamic v3 = _g3;
HXDLIN( 115)															_hx___ret->__SetField(HX_("followRedirect",ad,9d,29,cf),v3,hx::paccDynamic);
            														}
            													}
HXLINE( 112)													{
HXLINE( 112)														::Array< ::Dynamic> _g4 = ( (::Array< ::Dynamic>)(options->__Field(HX_("headers",46,52,08,63),hx::paccDynamic)) );
HXLINE(   1)														if (hx::IsNotNull( _g4 )) {
HXLINE( 112)															::Array< ::Dynamic> v4 = _g4;
HXDLIN( 112)															_hx___ret->__SetField(HX_("headers",46,52,08,63),v4,hx::paccDynamic);
            														}
            													}
            												}
HXLINE(  60)												this4 = _hx___ret;
            											}
            											else {
HXLINE(  60)												this4 = options;
            											}
HXDLIN(  60)											return ::tink::http::Fetch_obj::fetch(this3,this4);
            										}
            										HX_END_LOCAL_FUNC1(return)

HXLINE(  59)										 ::tink::http::ResponseHeaderBase res2 = ( ( ::tink::http::ResponseHeaderBase)(res1->header) );
HXDLIN(  59)										::String this1 = HX_("location",35,6e,46,e5).toLowerCase();
HXDLIN(  59)										::Dynamic this2 = ::tink::core::_Promise::Promise_Impl__obj::next( ::tink::core::_Future::SyncFuture_obj::__alloc( HX_CTX , ::tink::core::_Lazy::LazyConst_obj::__alloc( HX_CTX ,res2->byName(this1))), ::Dynamic(new _hx_Closure_0(options,code,url)),null());
HXDLIN(  59)										::tink::core::_Future::FutureObject_obj::handle(this2,cb);
            									}
            									else {
HXLINE(  62)										cb(::tink::core::Outcome_obj::Success(res1));
            									}
            								}
            								break;
            								default:{
HXLINE(  62)									cb(::tink::core::Outcome_obj::Success(res1));
            								}
            							}
            						}
            					}
            					break;
            					case (int)1: {
HXLINE(  64)						 ::tink::core::TypedError e = ( ( ::tink::core::TypedError)(res->_hx_getObject(0)) );
HXLINE(  65)						cb(::tink::core::Outcome_obj::Failure(e));
            					}
            					break;
            				}
            			}
            			HX_END_LOCAL_FUNC1((void))

            			HX_GC_STACKFRAME(&_hx_pos_f48f5e3cc0066c7c_27_fetch)
HXLINE(  29)			::String uri = ( (::String)(url->__Field(HX_("path",a5,e5,51,4a),hx::paccDynamic)) );
HXLINE(  30)			if (hx::IsNotNull( url->__Field(HX_("query",08,8b,ea,5d),hx::paccDynamic) )) {
HXLINE(  30)				uri = (uri + (HX_("?",3f,00,00,00) + ( (::String)(url->__Field(HX_("query",08,8b,ea,5d),hx::paccDynamic)) )));
            			}
HXLINE(  32)			::String method = HX_("GET",76,1c,36,00);
HXLINE(  33)			::Array< ::Dynamic> headers = null();
HXLINE(  34)			::Dynamic body = ::tink::io::_Source::Source_Impl__obj::EMPTY;
HXLINE(  35)			 ::tink::http::ClientType type = ::tink::http::ClientType_obj::Default_dyn();
HXLINE(  36)			bool followRedirect = true;
HXLINE(  38)			if (hx::IsNotNull( options )) {
HXLINE(  39)				if (hx::IsNotNull( options->__Field(HX_("method",e1,f6,5a,09),hx::paccDynamic) )) {
HXLINE(  39)					method = ( (::String)(options->__Field(HX_("method",e1,f6,5a,09),hx::paccDynamic)) );
            				}
HXLINE(  40)				if (hx::IsNotNull( options->__Field(HX_("headers",46,52,08,63),hx::paccDynamic) )) {
HXLINE(  40)					headers = ( (::Array< ::Dynamic>)(options->__Field(HX_("headers",46,52,08,63),hx::paccDynamic)) );
            				}
HXLINE(  41)				if (hx::IsNotNull( options->__Field(HX_("body",a2,7a,1b,41),hx::paccDynamic) )) {
HXLINE(  41)					body =  ::Dynamic(options->__Field(HX_("body",a2,7a,1b,41),hx::paccDynamic));
            				}
HXLINE(  42)				if (hx::IsNotNull( options->__Field(HX_("client",4b,ca,4f,0a),hx::paccDynamic) )) {
HXLINE(  42)					type = options->__Field(HX_("client",4b,ca,4f,0a),hx::paccDynamic);
            				}
HXLINE(  43)				if (hx::IsEq( options->__Field(HX_("followRedirect",ad,9d,29,cf),hx::paccDynamic),false )) {
HXLINE(  43)					followRedirect = false;
            				}
            			}
HXLINE(  46)			::Dynamic client = ::tink::http::Fetch_obj::getClient(type,hx::IsEq( url->__Field(HX_("scheme",25,20,c1,40),hx::paccDynamic),HX_("https",eb,7b,b1,2e) ));
HXLINE(  48)			bool _hx_tmp;
HXDLIN(  48)			if (hx::IsNotNull( options )) {
HXLINE(  48)				_hx_tmp = hx::IsNotNull( options->__Field(HX_("augment",11,3c,02,20),hx::paccDynamic) );
            			}
            			else {
HXLINE(  48)				_hx_tmp = false;
            			}
HXDLIN(  48)			if (_hx_tmp) {
HXLINE(  49)				 ::Dynamic pipeline = options->__Field(HX_("augment",11,3c,02,20),hx::paccDynamic);
HXDLIN(  49)				client = ::tink::http::_Client::CustomClient_obj::create(client,( (::Array< ::Dynamic>)(pipeline->__Field(HX_("before",7f,54,32,9a),hx::paccDynamic)) ),( (::Array< ::Dynamic>)(pipeline->__Field(HX_("after",1c,66,a2,1d),hx::paccDynamic)) ));
            			}
HXLINE(  51)			::tink::core::_Future::FutureObject_obj::handle(::tink::http::ClientObject_obj::request(client, ::tink::http::OutgoingRequest_obj::__alloc( HX_CTX , ::tink::http::OutgoingRequestHeader_obj::__alloc( HX_CTX ,method,url,null(),headers),body)), ::Dynamic(new _hx_Closure_1(followRedirect,options,url,cb)));
            		}
            		HX_END_LOCAL_FUNC1((void))

            	HX_STACKFRAME(&_hx_pos_f48f5e3cc0066c7c_27_fetch)
HXDLIN(  27)		return ::tink::core::_Future::Future_Impl__obj::async( ::Dynamic(new _hx_Closure_2(options,url)),null());
            	}


STATIC_HX_DEFINE_DYNAMIC_FUNC2(Fetch_obj,fetch,return )

::Dynamic Fetch_obj::getClient( ::tink::http::ClientType type,bool secure){
            	HX_GC_STACKFRAME(&_hx_pos_f48f5e3cc0066c7c_71_getClient)
HXLINE(  72)		 ::haxe::ds::EnumValueMap cache;
HXDLIN(  72)		if (secure) {
HXLINE(  72)			cache = ::tink::http::Fetch_obj::sclient;
            		}
            		else {
HXLINE(  72)			cache = ::tink::http::Fetch_obj::client;
            		}
HXLINE(  74)		if (!(cache->exists(type))) {
HXLINE(  76)			::Dynamic c;
HXDLIN(  76)			switch((int)(type->_hx_getIndex())){
            				case (int)0: {
HXLINE(  78)					if (secure) {
HXLINE(  76)						c =  ::tink::http::clients::SecureSocketClient_obj::__alloc( HX_CTX ,null());
            					}
            					else {
HXLINE(  76)						c =  ::tink::http::clients::SocketClient_obj::__alloc( HX_CTX ,null());
            					}
            				}
            				break;
            				case (int)1: {
HXLINE(  90)					 ::tink::http::containers::LocalContainer c1 = type->_hx_getObject(0).StaticCast<  ::tink::http::containers::LocalContainer >();
HXLINE(  76)					c =  ::tink::http::clients::LocalContainerClient_obj::__alloc( HX_CTX ,c1);
            				}
            				break;
            				case (int)2: {
HXLINE(  91)					if (secure) {
HXLINE(  76)						c =  ::tink::http::clients::SecureCurlClient_obj::__alloc( HX_CTX ,null());
            					}
            					else {
HXLINE(  76)						c =  ::tink::http::clients::CurlClient_obj::__alloc( HX_CTX ,null());
            					}
            				}
            				break;
            				case (int)3: {
HXLINE(  92)					if (secure) {
HXLINE(  76)						c =  ::tink::http::clients::StdClient_obj::__alloc( HX_CTX ,null());
            					}
            					else {
HXLINE(  76)						c =  ::tink::http::clients::StdClient_obj::__alloc( HX_CTX ,null());
            					}
            				}
            				break;
            				case (int)4: {
HXLINE(  93)					::Dynamic c2 = type->_hx_getObject(0);
HXLINE(  76)					c = c2;
            				}
            				break;
            			}
HXLINE( 102)			cache->set(type,c);
            		}
HXLINE( 105)		return cache->get(type);
            	}


STATIC_HX_DEFINE_DYNAMIC_FUNC2(Fetch_obj,getClient,return )


Fetch_obj::Fetch_obj()
{
}

bool Fetch_obj::__GetStatic(const ::String &inName, Dynamic &outValue, hx::PropertyAccess inCallProp)
{
	switch(inName.length) {
	case 5:
		if (HX_FIELD_EQ(inName,"fetch") ) { outValue = fetch_dyn(); return true; }
		break;
	case 6:
		if (HX_FIELD_EQ(inName,"client") ) { outValue = ( client ); return true; }
		break;
	case 7:
		if (HX_FIELD_EQ(inName,"sclient") ) { outValue = ( sclient ); return true; }
		break;
	case 9:
		if (HX_FIELD_EQ(inName,"getClient") ) { outValue = getClient_dyn(); return true; }
	}
	return false;
}

bool Fetch_obj::__SetStatic(const ::String &inName,Dynamic &ioValue,hx::PropertyAccess inCallProp)
{
	switch(inName.length) {
	case 6:
		if (HX_FIELD_EQ(inName,"client") ) { client=ioValue.Cast<  ::haxe::ds::EnumValueMap >(); return true; }
		break;
	case 7:
		if (HX_FIELD_EQ(inName,"sclient") ) { sclient=ioValue.Cast<  ::haxe::ds::EnumValueMap >(); return true; }
	}
	return false;
}

#ifdef HXCPP_SCRIPTABLE
static hx::StorageInfo *Fetch_obj_sMemberStorageInfo = 0;
static hx::StaticInfo Fetch_obj_sStaticStorageInfo[] = {
	{hx::fsObject /*  ::haxe::ds::EnumValueMap */ ,(void *) &Fetch_obj::client,HX_("client",4b,ca,4f,0a)},
	{hx::fsObject /*  ::haxe::ds::EnumValueMap */ ,(void *) &Fetch_obj::sclient,HX_("sclient",fe,22,74,b8)},
	{ hx::fsUnknown, 0, null()}
};
#endif

static void Fetch_obj_sMarkStatics(HX_MARK_PARAMS) {
	HX_MARK_MEMBER_NAME(Fetch_obj::client,"client");
	HX_MARK_MEMBER_NAME(Fetch_obj::sclient,"sclient");
};

#ifdef HXCPP_VISIT_ALLOCS
static void Fetch_obj_sVisitStatics(HX_VISIT_PARAMS) {
	HX_VISIT_MEMBER_NAME(Fetch_obj::client,"client");
	HX_VISIT_MEMBER_NAME(Fetch_obj::sclient,"sclient");
};

#endif

hx::Class Fetch_obj::__mClass;

static ::String Fetch_obj_sStaticFields[] = {
	HX_("client",4b,ca,4f,0a),
	HX_("sclient",fe,22,74,b8),
	HX_("fetch",3a,14,fa,fd),
	HX_("getClient",81,53,a6,86),
	::String(null())
};

void Fetch_obj::__register()
{
	Fetch_obj _hx_dummy;
	Fetch_obj::_hx_vtable = *(void **)&_hx_dummy;
	hx::Static(__mClass) = new hx::Class_obj();
	__mClass->mName = HX_("tink.http.Fetch",b0,a8,41,bc);
	__mClass->mSuper = &super::__SGetClass();
	__mClass->mConstructEmpty = &__CreateEmpty;
	__mClass->mConstructArgs = &__Create;
	__mClass->mGetStaticField = &Fetch_obj::__GetStatic;
	__mClass->mSetStaticField = &Fetch_obj::__SetStatic;
	__mClass->mMarkFunc = Fetch_obj_sMarkStatics;
	__mClass->mStatics = hx::Class_obj::dupFunctions(Fetch_obj_sStaticFields);
	__mClass->mMembers = hx::Class_obj::dupFunctions(0 /* sMemberFields */);
	__mClass->mCanCast = hx::TCanCast< Fetch_obj >;
#ifdef HXCPP_VISIT_ALLOCS
	__mClass->mVisitFunc = Fetch_obj_sVisitStatics;
#endif
#ifdef HXCPP_SCRIPTABLE
	__mClass->mMemberStorageInfo = Fetch_obj_sMemberStorageInfo;
#endif
#ifdef HXCPP_SCRIPTABLE
	__mClass->mStaticStorageInfo = Fetch_obj_sStaticStorageInfo;
#endif
	hx::_hx_RegisterClass(__mClass->mName, __mClass);
}

void Fetch_obj::__boot()
{
{
            	HX_GC_STACKFRAME(&_hx_pos_f48f5e3cc0066c7c_22_boot)
HXDLIN(  22)		client =  ::haxe::ds::EnumValueMap_obj::__alloc( HX_CTX );
            	}
{
            	HX_GC_STACKFRAME(&_hx_pos_f48f5e3cc0066c7c_23_boot)
HXDLIN(  23)		sclient =  ::haxe::ds::EnumValueMap_obj::__alloc( HX_CTX );
            	}
}

} // end namespace tink
} // end namespace http
