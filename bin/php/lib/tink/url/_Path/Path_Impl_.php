<?php
/**
 * Generated by Haxe 4.0.2
 */

namespace tink\url\_Path;

use \php\Boot;
use \php\_Boot\HxString;

final class Path_Impl_ {

	/**
	 * @param string $this
	 * @param string $that
	 * 
	 * @return string
	 */
	public static function join ($this1, $that) {
		#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:24: lines 24-31
		if ($that === "") {
			#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:24: characters 23-32
			return $this1;
		} else if (mb_substr($that, 0, 1) === "/") {
			#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:25: characters 31-35
			return $that;
		} else {
			#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:27: characters 13-18
			$index = mb_strlen($this1) - 1;
			#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:27: lines 27-31
			if ((($index < 0 ? "" : mb_substr($this1, $index, 1))) === "/") {
				#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:27: characters 20-52
				return Path_Impl_::ofString(($this1??'null') . ($that??'null'));
			} else {
				#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:28: characters 21-42
				$_g = HxString::lastIndexOf($this1, "/");
				if ($_g === -1) {
					#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:29: characters 20-24
					return $that;
				} else {
					#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:30: characters 16-17
					$v = $_g;
					#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:30: characters 11-47
					return Path_Impl_::ofString((mb_substr($this1, 0, $v + 1)??'null') . ($that??'null'));
				}
			}
		}
	}

	/**
	 * @param string $s
	 * 
	 * @return string
	 */
	public static function normalize ($s) {
		#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:38: characters 9-36
		$s = trim(\StringTools::replace($s, "\\", "/"));
		#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:39: lines 39-40
		if ($s === ".") {
			#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:40: characters 7-18
			return "./";
		}
		#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:42: characters 5-74
		$isDir = \StringTools::endsWith($s, "/..") || \StringTools::endsWith($s, "/") || \StringTools::endsWith($s, "/.");
		#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:44: lines 44-46
		$parts = new \Array_hx();
		$isAbsolute = \StringTools::startsWith($s, "/");
		$up = 0;
		#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:48: lines 48-55
		$_g = 0;
		$_g1 = HxString::split($s, "/");
		while ($_g < $_g1->length) {
			#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:48: characters 10-14
			$part = ($_g1->arr[$_g] ?? null);
			#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:48: lines 48-55
			++$_g;
			#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:49: characters 14-25
			$_g2 = trim($part);
			if ($_g2 === "") {
			} else if ($_g2 === ".") {
			} else if ($_g2 === "..") {
				#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:53: characters 15-26
				if ($parts->length > 0) {
					$parts->length--;
				}
				#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:53: characters 11-40
				if (array_pop($parts->arr) === null) {
					#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:53: characters 36-40
					++$up;
				}
			} else {
				#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:54: characters 14-15
				$v = $_g2;
				#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:54: characters 17-30
				$parts->arr[$parts->length] = $v;
				++$parts->length;

			}

		}

		#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:57: lines 57-61
		if ($isAbsolute) {
			#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:58: characters 7-24
			$parts->length = array_unshift($parts->arr, "");
		} else {
			#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:60: lines 60-61
			$_g21 = 0;
			$_g3 = $up;
			while ($_g21 < $_g3) {
				$i = $_g21++;
				#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:61: characters 9-28
				$parts->length = array_unshift($parts->arr, "..");
			}
		}
		#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:63: lines 63-64
		if ($isDir) {
			#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:64: characters 7-21
			$parts->arr[$parts->length] = "";
			++$parts->length;
		}
		#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:67: characters 5-27
		return $parts->join("/");
	}

	/**
	 * @param string $s
	 * 
	 * @return string
	 */
	public static function ofString ($s) {
		#/home/jahred/haxelib/tink_url/0,4,1/src/tink/url/Path.hx:34: characters 12-34
		$this1 = Path_Impl_::normalize($s);
		return $this1;
	}
}

Boot::registerClass(Path_Impl_::class, 'tink.url._Path.Path_Impl_');
